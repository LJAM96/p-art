<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Approve Changes - P-Art</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-dark bg-dark">
        <div class="container-fluid flex-wrap align-items-center gap-2">
            <a class="navbar-brand" href="/">P-Art</a>
            <div class="navbar-nav flex-row flex-wrap gap-2">
                <a class="nav-link" href="/">Run</a>
                <a class="nav-link" href="/config">Configuration</a>
                <a class="nav-link active" aria-current="page" href="/approve">Approve Changes</a>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <h1>Approve Changes</h1>
        {% if not changes %}
        <div class="alert alert-info">No artwork changes are awaiting approval.</div>
        {% else %}
        <form action="/apply_changes" method="post">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Title</th>
                        <th>Current Artwork</th>
                        <th>New Artwork</th>
                        <th>Source</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    {% for change in changes %}
                    <tr>
                        <td>{{ change.title }}</td>
                        <td>
                            {% if change.current_poster %}
                            <img src="{{ change.current_poster }}" alt="Current Poster" class="img-fluid">
                            {% elif change.current_background %}
                            <img src="{{ change.current_background }}" alt="Current Background" class="img-fluid">
                            {% endif %}
                        </td>
                        <td>
                            {% if change.new_poster %}
                            <img src="{{ change.new_poster }}" alt="New Poster" class="img-fluid">
                            {% elif change.new_background %}
                            <img src="{{ change.new_background }}" alt="New Background" class="img-fluid">
                            {% endif %}
                        </td>
                        <td>{{ change.source }}</td>
                        <td>
                            <input type="hidden" name="item_rating_key_{{ loop.index0 }}" value="{{ change.item_rating_key }}">
                            {% if change.new_poster %}
                            <input type="hidden" name="new_poster_{{ loop.index0 }}" value="{{ change.new_poster }}">
                            {% elif change.new_background %}
                            <input type="hidden" name="new_background_{{ loop.index0 }}" value="{{ change.new_background }}">
                            {% endif %}
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="action_{{ loop.index0 }}" value="approve" id="approve_{{ loop.index0 }}" checked>
                                <label class="form-check-label" for="approve_{{ loop.index0 }}">Approve</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="action_{{ loop.index0 }}" value="decline" id="decline_{{ loop.index0 }}">
                                <label class="form-check-label" for="decline_{{ loop.index0 }}">Decline</label>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            <br>
            <button type="submit" class="btn btn-primary">Apply Approved Changes</button>
        </form>
        {% endif %}
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
